<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Infection history gibbs proposal — inf_hist_prop_prior_v2_and_v4 • serosolver</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Infection history gibbs proposal — inf_hist_prop_prior_v2_and_v4" />

<meta property="og:description" content="Generates a new infection history matrix and corresponding individual likelihoods, using a gibbs sampler from the infection history prior. See infection_history_proposal_gibbs, as inputs are very similar." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">serosolver</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/cs1_vignette.html">Serosolver: paper case study 1</a>
    </li>
    <li>
      <a href="../articles/cs2_vignette.html">Serosolver: paper case study 2</a>
    </li>
    <li>
      <a href="../articles/serosolver-quick_start_guide.html">Serosolver: Quick Start Guide</a>
    </li>
  </ul>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/seroanalytics/serosolver">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Infection history gibbs proposal</h1>
    <small class="dont-index">Source: <a href='https://github.com/seroanalytics/serosolver/blob/master/R/RcppExports.R'><code>R/RcppExports.R</code></a></small>
    <div class="hidden name"><code>inf_hist_prop_prior_v2_and_v4.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>Generates a new infection history matrix and corresponding individual likelihoods, using a gibbs sampler from the infection history prior. See <code>infection_history_proposal_gibbs</code>, as inputs are very similar.</p>
    
    </div>

    <pre class="usage"><span class='fu'>inf_hist_prop_prior_v2_and_v4</span>(<span class='no'>theta</span>, <span class='no'>infection_history_mat</span>, <span class='no'>old_probs_1</span>,
  <span class='no'>sampled_indivs</span>, <span class='no'>n_years_samp_vec</span>, <span class='no'>age_mask</span>, <span class='no'>strain_mask</span>, <span class='no'>n_alive</span>,
  <span class='no'>n_infections</span>, <span class='no'>n_infected_group</span>, <span class='no'>prior_lookup</span>, <span class='no'>swap_propn</span>, <span class='no'>swap_distance</span>,
  <span class='no'>propose_from_prior</span>, <span class='no'>alpha</span>, <span class='no'>beta</span>, <span class='no'>circulation_times</span>,
  <span class='no'>circulation_times_indices</span>, <span class='no'>sample_times</span>, <span class='no'>rows_per_indiv_in_samples</span>,
  <span class='no'>cum_nrows_per_individual_in_data</span>,
  <span class='no'>cum_nrows_per_individual_in_repeat_data</span>, <span class='no'>nrows_per_blood_sample</span>,
  <span class='no'>group_id_vec</span>, <span class='no'>measurement_strain_indices</span>, <span class='no'>antigenic_map_long</span>,
  <span class='no'>antigenic_map_short</span>, <span class='no'>antigenic_distances</span>, <span class='no'>data</span>, <span class='no'>repeat_data</span>,
  <span class='no'>repeat_indices</span>, <span class='no'>titre_shifts</span>, <span class='no'>proposal_iter</span>, <span class='no'>accepted_iter</span>,
  <span class='no'>proposal_swap</span>, <span class='no'>accepted_swap</span>, <span class='no'>mus</span>, <span class='no'>boosting_vec_indices</span>, <span class='no'>total_alive</span>,
  <span class='kw'>temp</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>solve_likelihood</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>theta</th>
      <td><p>NumericVector, the named model parameters used to solve the model</p></td>
    </tr>
    <tr>
      <th>infection_history_mat</th>
      <td><p>IntegerMatrix the matrix of 1s and 0s corresponding to individual infection histories</p></td>
    </tr>
    <tr>
      <th>old_probs_1</th>
      <td><p>NumericVector, the current likelihoods for each individual</p></td>
    </tr>
    <tr>
      <th>sampled_indivs</th>
      <td><p>IntegerVector, indices of sampled individuals</p></td>
    </tr>
    <tr>
      <th>n_years_samp_vec</th>
      <td><p>int, for each individual, how many time periods to resample infections for?</p></td>
    </tr>
    <tr>
      <th>age_mask</th>
      <td><p>IntegerVector, length of the number of individuals, with indices specifying first time period that an individual can be infected (indexed from 1, such that a value of 1 allows an individual to be infected in any time period)</p></td>
    </tr>
    <tr>
      <th>strain_mask</th>
      <td><p>IntegerVector, length of the number of individuals, with indices specifying last time period that an individual can be infected (ie. last time a sample was taken)</p></td>
    </tr>
    <tr>
      <th>n_alive</th>
      <td><p>IntegerMatrix, number of columns is the number of time periods that an individual could be infected, giving the number of individual alive in each time period. Number of rows is the number of distinct groups.</p></td>
    </tr>
    <tr>
      <th>n_infections</th>
      <td><p>IntegerMatrix, the number of infections in each year (columns) for each group (rows)</p></td>
    </tr>
    <tr>
      <th>n_infected_group</th>
      <td><p>IntegerVector, the total number of infections across all times in each group</p></td>
    </tr>
    <tr>
      <th>prior_lookup</th>
      <td><p>NumericMatrix, the pre-computed lookup table for the beta prior on infection histories</p></td>
    </tr>
    <tr>
      <th>swap_propn</th>
      <td><p>double, gives the proportion of proposals that will be swap steps (ie. swap contents of two cells in infection_history rather than adding/removing infections)</p></td>
    </tr>
    <tr>
      <th>swap_distance</th>
      <td><p>int, in a swap step, how many time steps either side of the chosen time period to swap with</p></td>
    </tr>
    <tr>
      <th>alpha</th>
      <td><p>double, alpha parameter for beta prior on infection probability</p></td>
    </tr>
    <tr>
      <th>beta</th>
      <td><p>double, beta parameter for beta prior on infection probability</p></td>
    </tr>
    <tr>
      <th>circulation_times</th>
      <td><p>NumericVector, the times that each strain circulated</p></td>
    </tr>
    <tr>
      <th>circulation_times_indices</th>
      <td><p>IntegerVector, indexing vector from 0:(number of strains-1)</p></td>
    </tr>
    <tr>
      <th>sample_times</th>
      <td><p>NumericVector, the vector of real times that samples were taken</p></td>
    </tr>
    <tr>
      <th>rows_per_indiv_in_samples</th>
      <td><p>IntegerVector, How many rows in titre data correspond to each individual, sample and repeat?</p></td>
    </tr>
    <tr>
      <th>cum_nrows_per_individual_in_data</th>
      <td><p>IntegerVector, How many rows in the titre data correspond to each individual?</p></td>
    </tr>
    <tr>
      <th>cum_nrows_per_individual_in_repeat_data</th>
      <td><p>IntegerVector, For the repeat data (ie. already calculated these titres), how many rows in the titre data correspond to each individual?</p></td>
    </tr>
    <tr>
      <th>nrows_per_blood_sample</th>
      <td><p>IntegerVector, Split the sample times and runs for each individual</p></td>
    </tr>
    <tr>
      <th>group_id_vec</th>
      <td><p>IntegerVector, vector with 1 entry per individual, giving the group ID of that individual</p></td>
    </tr>
    <tr>
      <th>measurement_strain_indices</th>
      <td><p>IntegerVector, For each titre measurement, corresponding entry in antigenic map</p></td>
    </tr>
    <tr>
      <th>antigenic_map_long</th>
      <td><p>NumericVector, the collapsed cross reactivity map for long term boosting, after multiplying by sigma1, see <code><a href='create_cross_reactivity_vector.html'>create_cross_reactivity_vector</a></code></p></td>
    </tr>
    <tr>
      <th>antigenic_map_short</th>
      <td><p>NumericVector, the collapsed cross reactivity map for short term boosting, after multiplying by sigma2, see <code><a href='create_cross_reactivity_vector.html'>create_cross_reactivity_vector</a></code></p></td>
    </tr>
    <tr>
      <th>antigenic_distances</th>
      <td><p>NumericVector matching the dimensions of antigenic_map_long and antigenic_map_short, but with the raw antigenic distances between strains</p></td>
    </tr>
    <tr>
      <th>data</th>
      <td><p>NumericVector, data for all individuals for the first instance of each calculated titre</p></td>
    </tr>
    <tr>
      <th>repeat_data</th>
      <td><p>NumericVector, the repeat titre data for all individuals (ie. do not solve the same titres twice)</p></td>
    </tr>
    <tr>
      <th>repeat_indices</th>
      <td><p>IntegerVector, which index in the main data vector does each entry in repeat_data correspond to ie. which calculated titre in predicted_titres should be used for each observation?</p></td>
    </tr>
    <tr>
      <th>titre_shifts</th>
      <td><p>NumericVector, if length matches the length of <code>data</code>, adds these as measurement shifts to the predicted titres. If lengths do not match, is not used.</p></td>
    </tr>
    <tr>
      <th>proposal_iter</th>
      <td><p>IntegerVector, vector with entry for each individual, storing the number of infection history add/remove proposals for each individual.</p></td>
    </tr>
    <tr>
      <th>accepted_iter</th>
      <td><p>IntegerVector, vector with entry for each individual, storing the number of accepted infection history add/remove proposals for each individual.</p></td>
    </tr>
    <tr>
      <th>proposal_swap</th>
      <td><p>IntegerVector, vector with entry for each individual, storing the number of proposed infection history swaps</p></td>
    </tr>
    <tr>
      <th>accepted_swap</th>
      <td><p>IntegerVector, vector with entry for each individual, storing the number of accepted infection history swaps</p></td>
    </tr>
    <tr>
      <th>mus</th>
      <td><p>NumericVector, if length is greater than one, assumes that strain-specific boosting is used rather than a single boosting parameter</p></td>
    </tr>
    <tr>
      <th>boosting_vec_indices</th>
      <td><p>IntegerVector, same length as circulation_times, giving the index in the vector <code>mus</code> that each entry should use as its boosting parameter.</p></td>
    </tr>
    <tr>
      <th>total_alive</th>
      <td><p>IntegerVector, giving the total number of potential infection events for each group. This only applies to prior version 4. If set to a vector of values -1, then this is ignored.</p></td>
    </tr>
    <tr>
      <th>temp</th>
      <td><p>double, temperature for parallel tempering MCMC</p></td>
    </tr>
    <tr>
      <th>solve_likelihood</th>
      <td><p>bool, if FALSE does not solve likelihood when calculating acceptance probability</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>an R list with 6 entries: 1) the vector replacing old_probs_1, corresponding to the new likelihoods per individual; 2) the matrix of 1s and 0s corresponding to the new infection histories for all individuals; 3-6) the updated entries for proposal_iter, accepted_iter, proposal_swap and accepted_swap.</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>Other infection_history_proposal: <code><a href='inf_hist_prop_prior_v3.html'>inf_hist_prop_prior_v3</a></code></p></div>
    

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#see-also">See also</a></li>
          </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by James Hay, Adam Kucharski, Kylie Ainslie, Amanda Minter, Steven Riley.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
   </div>

  

  </body>
</html>

