<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Generate titre credible intervals — get_titre_predictions • serosolver</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Generate titre credible intervals — get_titre_predictions" />
<meta property="og:description" content="Generates credible intervals on titres and infection histories from an MCMC chain output." />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">serosolver</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/cs1_vignette.html">Paper case study 1: serosolver</a>
    </li>
    <li>
      <a href="../articles/cs2_vignette.html">Paper case study 2: serosolver</a>
    </li>
    <li>
      <a href="../articles/serosolver-quick_start_guide.html">Quick start guide for serosolver</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/seroanalytics/serosolver">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Generate titre credible intervals</h1>
    <small class="dont-index">Source: <a href='https://github.com/seroanalytics/serosolver/blob/master/R/plots.R'><code>R/plots.R</code></a></small>
    <div class="hidden name"><code>get_titre_predictions.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Generates credible intervals on titres and infection histories from an MCMC chain output.</p>
    </div>

    <pre class="usage"><span class='fu'>get_titre_predictions</span>(
  <span class='no'>chain</span>,
  <span class='no'>infection_histories</span>,
  <span class='no'>titre_dat</span>,
  <span class='no'>individuals</span>,
  <span class='kw'>antigenic_map</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>strain_isolation_times</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='no'>par_tab</span>,
  <span class='kw'>nsamp</span> <span class='kw'>=</span> <span class='fl'>100</span>,
  <span class='kw'>add_residuals</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>mu_indices</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>measurement_indices_by_time</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>for_res_plot</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>expand_titredat</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>titre_before_infection</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>titres_for_regression</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>chain</th>
      <td><p>the full MCMC chain to generate titre trajectories from</p></td>
    </tr>
    <tr>
      <th>infection_histories</th>
      <td><p>the MCMC chain for infection histories</p></td>
    </tr>
    <tr>
      <th>titre_dat</th>
      <td><p>the data frame of titre data</p></td>
    </tr>
    <tr>
      <th>individuals</th>
      <td><p>the subset of individuals to generate credible intervals for</p></td>
    </tr>
    <tr>
      <th>antigenic_map</th>
      <td><p>(optional) a data frame of antigenic x and y coordinates. Must have column names: x_coord; y_coord; inf_times. See <code><a href='example_antigenic_map.html'>example_antigenic_map</a></code></p></td>
    </tr>
    <tr>
      <th>strain_isolation_times</th>
      <td><p>(optional) if no antigenic map is specified, this argument gives the vector of times at which individuals can be infected</p></td>
    </tr>
    <tr>
      <th>par_tab</th>
      <td><p>the table controlling the parameters in the MCMC chain</p></td>
    </tr>
    <tr>
      <th>nsamp</th>
      <td><p>number of samples to take from posterior</p></td>
    </tr>
    <tr>
      <th>add_residuals</th>
      <td><p>if true, returns an extra output summarising residuals between the model prediction and data</p></td>
    </tr>
    <tr>
      <th>mu_indices</th>
      <td><p>vector of integers. for random effects on boosting parameter, mu. If random mus are included in the parameter table, this vector specifies which mu to use for each circulation year. For example, if years 1970-1976 have unique boosting, then mu_indices should be c(1,2,3,4,5,6). If every 3 year block shares has a unique boosting parameter, then this should be c(1,1,1,2,2,2)</p></td>
    </tr>
    <tr>
      <th>measurement_indices_by_time</th>
      <td><p>default NULL, optional vector giving the index of `measurement_bias` that each strain uses the measurement shift from from. eg. if there's 6 circulation years and 3 strain clusters</p></td>
    </tr>
    <tr>
      <th>for_res_plot</th>
      <td><p>TRUE/FALSE value. If using the output of this for plotting of residuals, returns the actual data points rather than summary statistics</p></td>
    </tr>
    <tr>
      <th>expand_titredat</th>
      <td><p>TRUE/FALSE value. If TRUE, solves titre predictions for all possible infection times. If left FALSE, then only solves for the infections times at which a titre against the circulating virus was measured in titre_dat.</p></td>
    </tr>
    <tr>
      <th>titre_before_infection</th>
      <td><p>TRUE/FALSE value. If TRUE, solves titre predictions, but gives the predicted titre at a given time point BEFORE any infection during that time occurs.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>a list with the titre predictions (95<!-- % credible intervals, median and multivariate posterior mode) and the probabilities of infection for each individual in each epoch --></p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='kw'>if</span> (<span class='fl'>FALSE</span>) {
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>example_theta_chain</span>)
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>example_inf_chain</span>)
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>example_titre_dat</span>)
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>example_antigenic_map</span>)
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>example_par_tab</span>)

<span class='no'>y</span> <span class='kw'>&lt;-</span> <span class='fu'>get_titre_predictions</span>(<span class='no'>example_theta_chain</span>, <span class='no'>example_inf_chain</span>, <span class='no'>example_titre_dat</span>,
                          <span class='fu'><a href='https://rdrr.io/r/base/unique.html'>unique</a></span>(<span class='no'>example_titre_dat</span>$<span class='no'>individual</span>), <span class='no'>example_antigenic_map</span>,
                          <span class='no'>example_par_tab</span>,<span class='kw'>expand_titredat</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)
}</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#value">Value</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by James Hay, Adam Kucharski, Kylie Ainslie, Amanda Minter, Steven Riley.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


