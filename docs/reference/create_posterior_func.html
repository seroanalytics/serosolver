<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Posterior function pointer — create_posterior_func • serosolver</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Posterior function pointer — create_posterior_func" />
<meta property="og:description" content="Takes all of the input data/parameters and returns a function pointer. This function finds the posterior for a given set of input parameters (theta) and infection histories without needing to pass the data set back and forth. No example is provided for function_type=2, as this should only be called within serosolver" />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">serosolver</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/cs1_vignette.html">Paper case study 1: serosolver</a>
    </li>
    <li>
      <a href="../articles/cs2_vignette.html">Paper case study 2: serosolver</a>
    </li>
    <li>
      <a href="../articles/serosolver-quick_start_guide.html">Quick start guide for serosolver</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/seroanalytics/serosolver">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Posterior function pointer</h1>
    <small class="dont-index">Source: <a href='https://github.com/seroanalytics/serosolver/blob/master/R/posteriors.R'><code>R/posteriors.R</code></a></small>
    <div class="hidden name"><code>create_posterior_func.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Takes all of the input data/parameters and returns a function pointer. This function finds the posterior for a given set of input parameters (theta) and infection histories without needing to pass the data set back and forth. No example is provided for function_type=2, as this should only be called within <code><a href='serosolver.html'>serosolver</a></code></p>
    </div>

    <pre class="usage"><span class='fu'>create_posterior_func</span>(
  <span class='no'>par_tab</span>,
  <span class='no'>titre_dat</span>,
  <span class='kw'>antigenic_map</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>strain_isolation_times</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>version</span> <span class='kw'>=</span> <span class='fl'>1</span>,
  <span class='kw'>solve_likelihood</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>age_mask</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>measurement_indices_by_time</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>mu_indices</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>n_alive</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>function_type</span> <span class='kw'>=</span> <span class='fl'>1</span>,
  <span class='kw'>titre_before_infection</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='no'>...</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>par_tab</th>
      <td><p>the parameter table controlling information such as bounds, initial values etc. See <code><a href='example_par_tab.html'>example_par_tab</a></code></p></td>
    </tr>
    <tr>
      <th>titre_dat</th>
      <td><p>the data frame of data to be fitted. Must have columns: group (index of group); individual (integer ID of individual); samples (numeric time of sample taken); virus (numeric time of when the virus was circulating); titre (integer of titre value against the given virus at that sampling time). See <code><a href='example_titre_dat.html'>example_titre_dat</a></code></p></td>
    </tr>
    <tr>
      <th>antigenic_map</th>
      <td><p>(optional) a data frame of antigenic x and y coordinates. Must have column names: x_coord; y_coord; inf_times. See <code><a href='example_antigenic_map.html'>example_antigenic_map</a></code></p></td>
    </tr>
    <tr>
      <th>strain_isolation_times</th>
      <td><p>(optional) if no antigenic map is specified, this argument gives the vector of times at which individuals can be infected</p></td>
    </tr>
    <tr>
      <th>version</th>
      <td><p>which version of the posterior function to solve (corresponds mainly to the infection history prior). Mostly just left to 1, but there is one special case where this should be set to 4 for the gibbs sampler. This is only really used by <code><a href='serosolver.html'>serosolver</a></code> to place the infection history prior on the total number of infections across all years and individuals when version = 4</p></td>
    </tr>
    <tr>
      <th>solve_likelihood</th>
      <td><p>usually set to TRUE. If FALSE, does not solve the likelihood and instead just samples/solves based on the model prior</p></td>
    </tr>
    <tr>
      <th>age_mask</th>
      <td><p>see <code><a href='create_age_mask.html'>create_age_mask</a></code> - a vector with one entry for each individual specifying the first epoch of circulation in which an individual could have been exposed</p></td>
    </tr>
    <tr>
      <th>measurement_indices_by_time</th>
      <td><p>if not NULL, then use these indices to specify which measurement bias parameter index corresponds to which time</p></td>
    </tr>
    <tr>
      <th>mu_indices</th>
      <td><p>if not NULL, then use these indices to specify which boosting parameter index corresponds to which time</p></td>
    </tr>
    <tr>
      <th>n_alive</th>
      <td><p>if not NULL, uses this as the number alive in a given year rather than calculating from the ages. This is needed if the number of alive individuals is known, but individual birth dates are not</p></td>
    </tr>
    <tr>
      <th>function_type</th>
      <td><p>integer specifying which version of this function to use. Specify 1 to give a posterior solving function; 2 to give the gibbs sampler for infection history proposals; otherwise just solves the titre model and returns predicted titres. NOTE that this is not the same as the attack rate prior argument, <code>version</code>!</p></td>
    </tr>
    <tr>
      <th>titre_before_infection</th>
      <td><p>TRUE/FALSE value. If TRUE, solves titre predictions, but gives the predicted titre at a given time point BEFORE any infection during that time occurs.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>other arguments to pass to the posterior solving function</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>a single function pointer that takes only pars and infection_histories as unnamed arguments. This function goes on to return a vector of posterior values for each individual</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='kw'>if</span> (<span class='fl'>FALSE</span>) {
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>example_par_tab</span>)
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>example_titre_dat</span>)
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>example_antigenic_map</span>)
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>example_inf_hist</span>)

<span class='co'>## Simple model solving code. Output matches entries of example_titre_dat</span>
<span class='no'>model_func</span> <span class='kw'>&lt;-</span> <span class='fu'>create_posterior_func</span>(<span class='no'>example_par_tab</span>, <span class='no'>example_titre_dat</span>, <span class='no'>example_antigenic_map</span>, <span class='kw'>function_type</span> <span class='kw'>=</span> <span class='fl'>3</span>)
<span class='no'>y</span> <span class='kw'>&lt;-</span> <span class='fu'>model_func</span>(<span class='no'>example_par_tab</span>$<span class='no'>values</span>, <span class='no'>example_inf_hist</span>)

<span class='co'>## Solve likelihood</span>
<span class='no'>par_tab</span> <span class='kw'>&lt;-</span> <span class='no'>example_par_tab</span>[<span class='no'>example_par_tab</span>$<span class='no'>names</span> <span class='kw'>!=</span> <span class='st'>"phi"</span>,]
<span class='no'>likelihood_func</span> <span class='kw'>&lt;-</span> <span class='fu'>create_posterior_func</span>(<span class='no'>par_tab</span>, <span class='no'>example_titre_dat</span>, <span class='no'>example_antigenic_map</span>, <span class='kw'>function_type</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>version</span> <span class='kw'>=</span> <span class='fl'>2</span>)
<span class='no'>liks</span> <span class='kw'>&lt;-</span> <span class='fu'>likelihood_func</span>(<span class='no'>par_tab</span>$<span class='no'>values</span>, <span class='no'>example_inf_hist</span>)
}</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#value">Value</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by James Hay, Adam Kucharski, Kylie Ainslie, Amanda Minter, Steven Riley.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


